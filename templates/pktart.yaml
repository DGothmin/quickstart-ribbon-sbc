AWSTemplateFormatVersion: '2010-09-09'
Description: AWS CloudFormation Template to setup and deploy vSBC HA instances and
  2 PKTART instances to test vSBC. This template creates required vpc, subnet and
  other routing elements required IAM role to performce IP movement betweenn two vSBC
  instances.
Parameters:
  AMIID:
    Description: 'AMI ID of SBC : ami-xxxxxxxx'
    Type: AWS::EC2::Image::Id
    MaxLength: '21'
    Default: ami-0a49b638bad956f96
    AllowedPattern: ami-[a-z0-9]*
    ConstraintDescription: Must be a valid AMI ID
  HFNAMIID:
    Description: 'AMI ID of Mangler Node, select latest AWS Linux AMI ID : ami-xxxxxxxx'
    Type: AWS::EC2::Image::Id
    MaxLength: '21'
    Default: ami-b70554c8
    AllowedPattern: ami-[a-z0-9]*
    ConstraintDescription: Must be a valid Mangler Instance AMI ID
  HFNScriptS3Location:
    Description: Location of Mangler script in S3, see installation guide for more
      details
    Type: String
    MinLength: '1'
    Default: s3://haforwarding/HFN.sh
    ConstraintDescription: Must be a valid S3 location
  PKTARTAMIID:
    Description: 'AMI ID of PKTART to load test SBC: ami-xxxxxxxx'
    Type: AWS::EC2::Image::Id
    MaxLength: '21'
    Default: ami-510c062b
    AllowedPattern: ami-[a-z0-9]*
    ConstraintDescription: Must be a valid Mangler Instance AMI ID
  KeyName:
    Description: 'Name of an existing EC2 KeyPair to enable SSH access to the SBC
      and Mangler instance '
    Type: AWS::EC2::KeyPair::KeyName
    ConstraintDescription: must be the name of an existing EC2 KeyPair.
  vpcCIDR:
    Description: VPC CIDR block for new VPC that will be used to create SBC and PKTART
      test tool.
    Type: String
    Default: 10.74.0.0/16
    AllowedPattern: (\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})/(\d{1,2})
    ConstraintDescription: Must be a valid IP CIDR range of the form x.x.x.x/x.
  SBCManagementSubnetCIDR:
    Description: Enter a CIDR for pirvate subnet for SBC, this new subnet will be
      served by Mangler instance.
    Type: String
    MinLength: '1'
    Default: 10.74.10.0/24
    AllowedPattern: (\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})/(\d{1,2})
    ConstraintDescription: Must be a valid IP CIDR range of the form x.x.x.x/x and
      subnet of VPC.
  SBCHASubnetCIDR:
    Description: Enter a CIDR for pirvate subnet for SBC, this new subnet will be
      served by Mangler instance.
    Type: String
    MinLength: '1'
    Default: 10.74.20.0/24
    AllowedPattern: (\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})/(\d{1,2})
    ConstraintDescription: Must be a valid IP CIDR range of the form x.x.x.x/x and
      subnet of VPC.
  SBCExVoipSubnetCIDR:
    Description: Enter a CIDR for pirvate subnet for SBC, this new subnet will be
      served by Mangler instance.
    Type: String
    MinLength: '1'
    Default: 10.74.40.0/24
    AllowedPattern: (\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})/(\d{1,2})
    ConstraintDescription: Must be a valid IP CIDR range of the form x.x.x.x/x and
      subnet of VPC.
  HFNPublicPktSubnetCIDR:
    Description: Enter a CIDR for pirvate subnet for SBC, this new subnet will be
      served by Mangler instance.
    Type: String
    MinLength: '1'
    Default: 10.74.50.0/24
    AllowedPattern: (\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})/(\d{1,2})
    ConstraintDescription: Must be a valid IP CIDR range of the form x.x.x.x/x and
      subnet of VPC.
  HFNTowardsSBCSubnetCIDR:
    Description: Enter a CIDR for pirvate subnet for SBC, this new subnet will be
      served by Mangler instance.
    Type: String
    MinLength: '1'
    Default: 10.74.60.0/24
    AllowedPattern: (\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})/(\d{1,2})
    ConstraintDescription: Must be a valid IP CIDR range of the form x.x.x.x/x and
      subnet of VPC.
  NumberOfAlternateIPOnPkt1:
    Description: Enter Number of IPs required on PKT1 port
    Type: Number
    Default: '1'
    MaxValue: '14'
    MinValue: '1'
  EipAssociationForHFEMgt:
    Description: Do you want EIP on Management Interface of Mangler? Select Yes if
      you want to manage Mangler instance using EIP.
    Type: String
    Default: 'Yes'
    AllowedValues:
      - 'Yes'
      - 'No'
  remoteSSHMachinePublicIP:
    Description: Do you want to connect Management Interface of Mangler using EIP?
      Enter IP(public IP) of machine that will connect(SSH) to Mangler using public
      IP
    Type: String
    Default: ''
  availabilityZoneForSBC:
    Description: Enter Availability Zone for SBC, New subnets for SBC will be created
      here.
    Type: AWS::EC2::AvailabilityZone::Name
  InstanceType:
    Description: EC2 instance type
    Type: String
    Default: m5.xlarge
    AllowedValues:
      - m4.xlarge
      - m5.xlarge
      - c3.2xlarge
      - c3.4xlarge
      - c3.8xlarge
      - c4.2xlarge
      - c4.4xlarge
      - c4.8xlarge
      - c5.2xlarge
      - c5.4xlarge
      - c5.8xlarge
    ConstraintDescription: Must be a valid EC2 instance type.
  PKTARTInstanceType:
    Description: PKTART instance type
    Type: String
    Default: c5.2xlarge
    AllowedValues:
      - c5.2xlarge
      - c5.4xlarge
    ConstraintDescription: Must be a valid PKTART instance type.
  SBCPersonality:
    Description: SBC Personality type, with Mangler we support only isbc
    Type: String
    Default: isbc
    AllowedValues:
      - isbc
    ConstraintDescription: Must be a valid SBC Personality type.
  ActiveInstanceName:
    Description: CE name of the active instance
    Type: String
    Default: vsbc1
    MaxLength: '63'
    AllowedPattern: ^[A-Za-z]{1}[-A-Za-z0-9.]*[A-Za-z0-9]{1}$
    ConstraintDescription: 'Enter valid ceName(instance name).  Regex: ^[A-Za-z]{1}[-A-Za-z0-9.]*[A-Za-z0-9]{1}$'
  StandbyInstanceName:
    Description: CE name of the standby instance
    Type: String
    Default: vsbc2
    MaxLength: '63'
    AllowedPattern: ^[A-Za-z]{1}[-A-Za-z0-9.]*[A-Za-z0-9]{1}$
    ConstraintDescription: 'Enter valid ceName(instance name).  Regex: ^[A-Za-z]{1}[-A-Za-z0-9.]*[A-Za-z0-9]{1}$'
  SystemName:
    Description: System Name
    Type: String
    Default: vsbcSystem
    MaxLength: '26'
    AllowedPattern: ^[A-Za-z]{1}[-A-Za-z0-9]*[A-Za-z0-9]{1}$
    ConstraintDescription: 'Enter valid system name.  Regex: ^[A-Za-z]{1}[-A-Za-z0-9]*[A-Za-z0-9]{1}$ '
  sshAccessCIDR:
    Description: IP CIDR from where you could SSH into SBC and PKTART instances
    Type: String
    MinLength: '9'
    MaxLength: '18'
    Default: '0.0.0.0/0'
    AllowedPattern: (\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})/(\d{1,2})
    ConstraintDescription: must be a valid CIDR range of the form x.x.x.x/x.
  Tenancy:
    Description: Tenancy attribute for SBC instances
    Type: String
    Default: default
    AllowedValues:
      - default
      - dedicated
  PlacementId:
    Description: PlacementGroup to launch SBC instances(Optional)
    Type: String
    Default: ''
  VolumeType:
    Description: Select Type of Volume for SBC
    Type: String
    Default: io1
    AllowedValues:
      - gp2
      - io1
  vpcEndPointBasedEc2APIAccess:
    Description: Do you want to create VPC End-point to access API server? if you
      select no then SBC will reach API server using EIP on mgt0 ports
    Type: String
    Default: 'yes'
    AllowedValues:
      - 'yes'
      - 'no'
  IOPS:
    Description: Enter IOPS reservation for io1 type EBS volume [<= 1950], for gp2
      EBS volumes this value is ignored by template.
    Type: Number
    Default: '600'
    MaxValue: '1950'
  VolumeSize:
    Description: Enter size of disk in GiB. Minimum disk required is 65 GiB
    Type: Number
    Default: '65'
    MinValue: '65'
    MaxValue: '1000'
Conditions:
  EipOnPkt0: !Equals
    - 'true'
    - 'true'
  MatchingCeNames: !Equals
    - !Ref 'ActiveInstanceName'
    - !Ref 'StandbyInstanceName'
  MatchingActiveCeAndSystemName: !Equals
    - !Ref SBCSystemName
    - !Ref 'ActiveInstanceName'
  MatchingStandbyCeAndSystemName: !Equals
    - !Ref SBCSystemName
    - !Ref 'StandbyInstanceName'
  NameMismatchError: !Or
    - !Condition 'MatchingCeNames'
    - !Condition 'MatchingActiveCeAndSystemName'
    - !Condition 'MatchingStandbyCeAndSystemName'
  NameValidationPassed: !Not
    - !Condition 'NameMismatchError'
  VolumeTypeIO1: !Equals
    - !Ref 'VolumeType'
    - io1
  vpcEndPointBasedEc2Access: !Equals
    - !Ref 'vpcEndPointBasedEc2APIAccess'
    - 'yes'
  EipForPKTART: !Equals
    - 'Yes'
    - 'Yes'
  EipForHFEMgt: !Equals
    - !Ref 'EipAssociationForHFEMgt'
    - 'Yes'
  noVPCEndPointForMgt: !Equals
    - !Ref 'vpcEndPointBasedEc2APIAccess'
    - 'no'
Resources:
  SBCActiveInstanceRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Principal:
              Service:
                - ec2.amazonaws.com
            Action:
              - sts:AssumeRole
      Path: /
      Policies:
        - PolicyName: root
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
              - Effect: Allow
                Action:
                  - ec2:AllocateAddress
                  - ec2:AssignPrivateIpAddresses
                  - ec2:AssociateAddress
                  - ec2:AttachNetworkInterface
                  - ec2:DisassociateAddress
                  - ec2:DescribeInstances
                  - ec2:DescribeAddresses
                  - ec2:DescribeNetworkInterfaces
                  - ec2:DescribeInstanceAttribute
                  - ec2:DescribeRegions
                  - s3:Get*
                  - s3:List*
                  - ec2:ModifyInstanceAttribute
                  - ec2:DescribeSubnets
                Resource: '*'
    Metadata:
      AWS::CloudFormation::Designer:
        id: 9e06684e-8dc2-4a28-abce-032d28c96f15
  SBCEndPoint:
    Type: AWS::EC2::VPCEndpoint
    Condition: vpcEndPointBasedEc2Access
    Properties:
      VpcEndpointType: Interface
      PrivateDnsEnabled: 'True'
      SubnetIds:
        - !Ref 'SBCManagementSubnet'
      SecurityGroupIds:
        - !Ref 'SBCManagementSG'
      ServiceName: !Join
        - ''
        - - com.amazonaws.
          - !Ref 'AWS::Region'
          - .ec2
      VpcId: !Ref 'vpc'
  SBCActiveInstanceProfile:
    Type: AWS::IAM::InstanceProfile
    Properties:
      Path: /
      Roles:
        - !Ref 'SBCActiveInstanceRole'
      InstanceProfileName: sweIAMProfile
    Metadata:
      AWS::CloudFormation::Designer:
        id: 513abf27-ab1b-4f87-85ed-dfdc313a4ef7
SBCHFNInstanceProfile:
    Type: AWS::IAM::InstanceProfile
    Properties:
      Path: /
      Roles:
        - !Ref 'SBCActiveInstanceRole'
      InstanceProfileName: sweHFNIAMProfile
    Metadata:
      AWS::CloudFormation::Designer:
        id: 34ea8f05-a010-4451-bba1-0a76dc41df9e
  SBCActiveMgtIface:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'SBCManagementSubnet'
      Description: !Join
        - '-'
        - - !Ref SBCSystemName
          - mgt0A_Ribbon
      GroupSet:
        - !Ref 'SBCManagementSG'
      SecondaryPrivateIpAddressCount: 1
      SourceDestCheck: 'true'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref SBCSystemName
              - mgt0A_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: 707aa6db-298f-4ad3-9852-dff6a57b6117
  SBCActiveHAIface:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'SBCHASubnet'
      Description: !Join
        - '-'
        - - !Ref SBCSystemName
          - ha0A_Ribbon
      GroupSet:
        - !Ref 'securityGrpHa'
      SourceDestCheck: 'true'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref SBCSystemName
              - ha0A_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: 51a951cd-ae03-4bff-a603-14f732be91d1
  SBCActiveIVface:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'HFEPrivateSubnet'
      Description: !Join
        - '-'
        - - !Ref SBCSystemName
          - pkt0A_Ribbon
      GroupSet:
        - !Ref 'securityGrpPktTrusted'
      SecondaryPrivateIpAddressCount: 1
      SourceDestCheck: 'false'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref SBCSystemName
              - pkt0A_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: 83463436-053b-441a-b7a3-203b0b4d6555
  SBCActiveEVface:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'SBCExVoipSubnet'
      Description: !Join
        - '-'
        - - !Ref SBCSystemName
          - pkt1A_Ribbon
      GroupSet:
        - !Ref 'securityGrpPktTrusted'
      SecondaryPrivateIpAddressCount: 1
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref SBCSystemName
              - pkt1A_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: 30b47652-4e3b-4e80-9241-e372d45af309
  SBCPassiveMgtIface:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'SBCManagementSubnet'
      Description: !Join
        - '-'
        - - !Ref SBCSystemName
          - mgt0B_Ribbon
      GroupSet:
        - !Ref 'SBCManagementSG'
      SourceDestCheck: 'true'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref SBCSystemName
              - mgt0B_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: '00b911a7-2e7d-4201-9de0-db41c4ccbc0f'
  SBCPassiveHAIface:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'SBCHASubnet'
      Description: !Join
        - '-'
        - - !Ref 'SystemName'
          - ha0B_Ribbon
      GroupSet:
        - !Ref 'securityGrpHa'
      SourceDestCheck: 'true'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - ha0B_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: 36268cbd-38bd-48ec-a98a-d2b8d92cab21
  SBCPassiveIVIface:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'HFEPrivateSubnet'
      Description: !Join
        - '-'
        - - !Ref 'SystemName'
          - pkt0B_Ribbon
      GroupSet:
        - !Ref 'securityGrpPktTrusted'
      SourceDestCheck: 'false'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - pkt0B_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: 69dd4dbe-e79a-4dd6-a2c7-a8057eac1a37
  SBCPassiveEVIface:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'SBCExVoipSubnet'
      Description: !Join
        - '-'
        - - !Ref 'SystemName'
          - pkt1B_Ribbon
      GroupSet:
        - !Ref 'securityGrpPktTrusted'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - pkt1B_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: 7cf86ffa-02d6-4532-a19d-e74d02805435
  PKTARTMgtA:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'SBCManagementSubnet'
      Description: !Join
        - '-'
        - - !Ref 'SystemName'
          - PKTARTMgtA_Ribbon
      GroupSet:
        - !Ref 'securityGrpMgtPktart'
      SourceDestCheck: 'true'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - PKTARTMgtA_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: 6b3d4631-2742-42aa-8ccb-91ff44b4c6e3
  PKTARTPkt0:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'HFEPublicSubnet'
      Description: !Join
        - '-'
        - - !Ref 'SystemName'
          - PKTARTPkt0_Ribbon
      GroupSet:
        - !Ref 'securityGrpPktTrusted'
      SourceDestCheck: 'true'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - PKTARTPkt0_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: f7fb0f52-ff36-4b59-bc5b-217c387fbc47
  PKTARTMgtB:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'SBCManagementSubnet'
      Description: !Join
        - '-'
        - - !Ref 'SystemName'
          - PKTARTMgtB_Ribbon
      GroupSet:
        - !Ref 'securityGrpMgtPktart'
      SourceDestCheck: 'true'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - PKTARTMgtB_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: b68a0266-c1cc-4194-81c1-44d68061a4b2
  PKTARTPkt1:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'SBCExVoipSubnet'
      Description: !Join
        - '-'
        - - !Ref 'SystemName'
          - PKTARTPkt1_Ribbon
      GroupSet:
        - !Ref 'securityGrpPktTrusted'
      SourceDestCheck: 'false'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - PKTARTPkt1_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: f679c8dc-690f-4034-8bfb-2eee03d54a82
  vpc:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: !Ref 'vpcCIDR'
      InstanceTenancy: default
      EnableDnsSupport: 'true'
      EnableDnsHostnames: 'true'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - VPC_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: 7b71f416-4973-476d-bedb-b332394c7da9
  internetGw:
    Type: AWS::EC2::InternetGateway
    Properties:
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - IGW_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: 229e8cd7-1798-42ce-8ce6-b0a0a450eea3
  vpcInternetGwAssociation:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      InternetGatewayId: !Ref 'internetGw'
      VpcId: !Ref 'vpc'
    Metadata:
      AWS::CloudFormation::Designer:
        id: bf4c840c-e410-459b-921c-0db5161ab36c
  privateRouteTable:
    Type: AWS::EC2::RouteTable
    Properties:
      VpcId: !Ref 'vpc'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - PrivateRouteTable_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
  privateRoute:
    Type: AWS::EC2::Route
    Properties:
      RouteTableId: !Ref 'privateRouteTable'
      DestinationCidrBlock: '0.0.0.0/0'
      GatewayId: !Ref 'internetGw'
    Metadata:
      AWS::CloudFormation::Designer:
        id: 90ec2540-d898-4e67-a372-91ff0651b6f5
  HFNPrivateRouteTable:
    Type: AWS::EC2::RouteTable
    Properties:
      VpcId: !Ref 'vpc'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - HFNPrivateRouteTable
  HFNPrivateRoute:
    Type: AWS::EC2::Route
    DependsOn: HFNPrivate
    Properties:
      RouteTableId: !Ref 'HFNPrivateRouteTable'
      DestinationCidrBlock: '0.0.0.0/0'
      NetworkInterfaceId: !Ref 'HFNPrivate'
  HFNPrivateRouteAssociation:
    Type: AWS::EC2::SubnetRouteTableAssociation
    Properties:
      RouteTableId: !Ref 'HFNPrivateRouteTable'
      SubnetId: !Ref 'HFEPrivateSubnet'
  SBCManagementSubnetGwAssociation:
    Type: AWS::EC2::SubnetRouteTableAssociation
    Properties:
      RouteTableId: !Ref 'privateRouteTable'
      SubnetId: !Ref 'SBCManagementSubnet'
    Metadata:
      AWS::CloudFormation::Designer:
        id: cc96f861-6568-4d28-a28f-dc992218f776
  HFNPublicSubnetGwAssociation:
    Type: AWS::EC2::SubnetRouteTableAssociation
    Properties:
      RouteTableId: !Ref 'privateRouteTable'
      SubnetId: !Ref 'HFEPublicSubnet'
    Metadata:
      AWS::CloudFormation::Designer:
        id: 6d21e83b-ffe7-4d07-a8d1-7e64a97cdeb4
  SBCManagementSubnet:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref 'vpc'
      CidrBlock: !Ref 'SBCManagementSubnetCIDR'
      AvailabilityZone: !Ref 'availabilityZoneForSBC'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - mgt_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: '00805611-6a39-4c0c-940d-dd2322aaec8b'
  SBCHASubnet:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref 'vpc'
      CidrBlock: !Ref 'SBCHASubnetCIDR'
      AvailabilityZone: !Ref 'availabilityZoneForSBC'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - ha_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: f92c50bc-9290-4c7d-8e37-6b0bab95b230
  SBCExVoipSubnet:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref 'vpc'
      CidrBlock: !Ref 'SBCExVoipSubnetCIDR'
      AvailabilityZone: !Ref 'availabilityZoneForSBC'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - pkt1_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: d835a872-3e6c-457a-b919-8bd3050a07ee
  SBCManagementSG:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Security group for Mgt SBC
      VpcId: !Ref 'vpc'
      SecurityGroupIngress:
        - IpProtocol: '-1'
          FromPort: '-1'
          ToPort: '-1'
          CidrIp: '0.0.0.0/0'
        - IpProtocol: '-1'
          FromPort: '-1'
          ToPort: '-1'
          CidrIp: !Ref 'sshAccessCIDR'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - SecurityGroup1_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
  SBCActiveMgtEIP:
    Type: AWS::EC2::EIP
    Condition: noVPCEndPointForMgt
    Properties:
      Domain: vpc
    Metadata:
      AWS::CloudFormation::Designer:
        id: 513f2db5-2c59-4102-99aa-5ffd5bfe2508
  SBCActiveMgtEIPAssocaition:
    Type: AWS::EC2::EIPAssociation
    Condition: noVPCEndPointForMgt
    Properties:
      AllocationId: !GetAtt 'SBCActiveMgtEIP.AllocationId'
      NetworkInterfaceId: !Ref 'SBCActiveMgtIface'
      PrivateIpAddress: !GetAtt 'SBCActiveMgtIface.PrimaryPrivateIpAddress'
    Metadata:
      AWS::CloudFormation::Designer:
        id: c2eac22a-dac3-43e8-a269-655a747809a3
  SBCPassiveMgtEIP:
    Type: AWS::EC2::EIP
    Condition: noVPCEndPointForMgt
    Properties:
      Domain: vpc
    Metadata:
      AWS::CloudFormation::Designer:
        id: '072d5305-c1c0-4a9c-afda-2433e6e46df7'
  SBCPassiveMgtEIPAssociation:
    Type: AWS::EC2::EIPAssociation
    Condition: noVPCEndPointForMgt
    Properties:
      AllocationId: !GetAtt 'SBCPassiveMgtEIP.AllocationId'
      NetworkInterfaceId: !Ref 'SBCPassiveMgtIface'
      PrivateIpAddress: !GetAtt 'SBCPassiveMgtIface.PrimaryPrivateIpAddress'
    Metadata:
      AWS::CloudFormation::Designer:
        id: 4e8273a2-eda6-4000-bce9-66101cd18776
  mgtPKTARTA:
    Type: AWS::EC2::EIP
    Condition: EipForPKTART
    Properties:
      Domain: vpc
    Metadata:
      AWS::CloudFormation::Designer:
        id: d0e9f652-4f8a-44f9-bfe5-2a978a9df748
  mgtPKTARTB:
    Type: AWS::EC2::EIP
    Condition: EipForPKTART
    Properties:
      Domain: vpc
    Metadata:
      AWS::CloudFormation::Designer:
        id: '088537d6-da3e-4165-9cf2-356b0fe045b1'
  mgtPKTARTAEIPAssociation:
    Type: AWS::EC2::EIPAssociation
    Condition: NameValidationPassed
    Properties:
      AllocationId: !GetAtt 'mgtPKTARTA.AllocationId'
      NetworkInterfaceId: !Ref 'PKTARTMgtA'
    Metadata:
      AWS::CloudFormation::Designer:
        id: b937381e-0b5e-4899-8f9f-fe3a66be91c4
  pktPKTARTA:
    Type: AWS::EC2::EIP
    Properties:
      Domain: vpc
  pktPKTARTAEIPAssociation:
    Type: AWS::EC2::EIPAssociation
    Properties:
      AllocationId: !GetAtt 'pktPKTARTA.AllocationId'
      NetworkInterfaceId: !Ref 'PKTARTPkt0'
  HFEMgtEIPAssociation:
    Type: AWS::EC2::EIPAssociation
    Condition: EipForHFEMgt
    Properties:
      AllocationId: !GetAtt 'HFEMgtEIP.AllocationId'
      NetworkInterfaceId: !Ref 'HFEMgt'
    Metadata:
      AWS::CloudFormation::Designer:
        id: 7fdb903d-a9c1-410b-b61b-f48b455b9b31
  SBCActiveMgtEIP:
    Type: AWS::EC2::EIP
    Condition: noVPCEndPointForMgt
    Properties:
      Domain: vpc
    Metadata:
      AWS::CloudFormation::Designer:
        id: 7017e578-ebf0-497d-998e-e46e5515d284
  SBCActiveMgtEIPAssocaition:
    Type: AWS::EC2::EIPAssociation
    Condition: noVPCEndPointForMgt
    Properties:
      AllocationId: !GetAtt 'SBCActiveMgtEIP.AllocationId'
      NetworkInterfaceId: !Ref 'SBCActiveMgtIface'
      PrivateIpAddress: !Select
        - '0'
        - !GetAtt 'SBCActiveMgtIface.SecondaryPrivateIpAddresses'
    Metadata:
      AWS::CloudFormation::Designer:
        id: 8fdffd5a-b411-458e-9f0c-4504c85d2dcd
  SBCActiveInstance:
    Type: AWS::EC2::Instance
    Condition: NameValidationPassed
    Properties:
      ImageId: !Ref 'AMIID'
      IamInstanceProfile: !Ref 'SBCActiveInstanceProfile'
      BlockDeviceMappings:
        - DeviceName: /dev/sda1
          Ebs:
            VolumeType: !Ref 'VolumeType'
            VolumeSize: !Ref 'VolumeSize'
            Iops: !If
              - VolumeTypeIO1
              - !Ref 'IOPS'
              - !Ref 'AWS::NoValue'
            DeleteOnTermination: 'true'
      InstanceType: !Ref 'InstanceType'
      Tenancy: !Ref 'Tenancy'
      PlacementGroupName: !Ref 'PlacementId'
      EbsOptimized: 'True'
      KeyName: !Ref 'KeyName'
      NetworkInterfaces:
        - NetworkInterfaceId: !Ref 'SBCActiveMgtIface'
          DeviceIndex: '0'
        - NetworkInterfaceId: !Ref 'SBCActiveHAIface'
          DeviceIndex: '1'
        - NetworkInterfaceId: !Ref 'SBCActiveIVface'
          DeviceIndex: '2'
        - NetworkInterfaceId: !Ref 'SBCActiveEVface'
          DeviceIndex: '3'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'AWS::StackName'
              - '1'
      UserData: !Base64
        Fn::Join:
          - ''
          - - '{ "'
            - CERole
            - '" : "'
            - ACTIVE
            - '"'
            - ', "ReverseNatPkt0"       : "'
            - 'True'
            - '"'
            - ', "ReverseNatPkt1"       : "'
            - 'False'
            - '"'
            - ', "IAM_ROLE"             : "'
            - !Ref 'SBCActiveInstanceRole'
            - '"'
            - ', "ALT_Mgt0_00"          : "LOGICAL_MGMT_IP"'
            - ', "ALT_Pkt0_00"          : "VIP1"'
            - ', "ALT_Pkt1_00"          : "VIP2"'
            - ', "ClusterIp"            : "'
            - !GetAtt 'SBCPassiveHAIface.PrimaryPrivateIpAddress'
            - '"'
            - ', "HFN"                  : "'
            - !Select
              - '0'
              - !GetAtt 'HFNPublic.SecondaryPrivateIpAddresses'
            - '"'
            - ', "SbcPersonalityType"   : "'
            - !Ref 'SBCPersonality'
            - '"'
            - ', "SbcMgmtMode"          : "centralized"'
            - ', "TemplateName"         : "AWS_HA_template.json"'
            - ', "TemplateVersion"      : "V07.00.00A011"'
            - ', "CEName"               : "'
            - !Ref 'ActiveInstanceName'
            - '"'
            - ', "PeerCEName"           : "'
            - !Ref 'StandbyInstanceName'
            - '"'
            - ', "PeerCEHa0IPv4Address" : "'
            - !GetAtt 'SBCPassiveHAIface.PrimaryPrivateIpAddress'
            - '"'
            - ', "SystemName"           : "'
            - !Ref 'SystemName'
            - '"'
            - ', "ActiveRoleMgtId"      : "'
            - !Ref 'SBCActiveMgtIface'
            - '"'
            - ', "NodeName"             : "'
            - !Ref 'AWS::StackName'
            - '" }'
    Metadata:
      AWS::CloudFormation::Designer:
        id: ccbc183f-09eb-4dc7-a4d9-0cc3a2ede5e8
  SBCPassiveInstance:
    Type: AWS::EC2::Instance
    Condition: NameValidationPassed
    Properties:
      ImageId: !Ref 'AMIID'
      BlockDeviceMappings:
        - DeviceName: /dev/sda1
          Ebs:
            VolumeType: !Ref 'VolumeType'
            VolumeSize: !Ref 'VolumeSize'
            Iops: !If
              - VolumeTypeIO1
              - !Ref 'IOPS'
              - !Ref 'AWS::NoValue'
            DeleteOnTermination: 'true'
      IamInstanceProfile: !Ref 'SBCActiveInstanceProfile'
      InstanceType: !Ref 'InstanceType'
      Tenancy: !Ref 'Tenancy'
      PlacementGroupName: !Ref 'PlacementId'
      EbsOptimized: 'True'
      KeyName: !Ref 'KeyName'
      NetworkInterfaces:
        - NetworkInterfaceId: !Ref 'SBCPassiveMgtIface'
          DeviceIndex: '0'
        - NetworkInterfaceId: !Ref 'SBCPassiveHAIface'
          DeviceIndex: '1'
        - NetworkInterfaceId: !Ref 'SBCPassiveIVIface'
          DeviceIndex: '2'
        - NetworkInterfaceId: !Ref 'SBCPassiveEVIface'
          DeviceIndex: '3'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'AWS::StackName'
              - '2'
      UserData: !Base64
        Fn::Join:
          - ''
          - - '{ "'
            - CERole
            - '" : "'
            - STANDBY
            - '"'
            - ', "ReverseNatPkt0"       : "'
            - 'True'
            - '"'
            - ', "ReverseNatPkt1"       : "'
            - 'False'
            - '"'
            - ', "IAM_ROLE"             : "'
            - !Ref 'SBCActiveInstanceRole'
            - '"'
            - ', "ALT_Mgt0_00"          : "LOGICAL_MGMT_IP"'
            - ', "ALT_Pkt0_00"          : "VIP1"'
            - ', "ALT_Pkt1_00"          : "VIP2"'
            - ', "ClusterIp"            : "'
            - !GetAtt 'SBCActiveHAIface.PrimaryPrivateIpAddress'
            - '"'
            - ', "HFN"                  : "'
            - !Select
              - '0'
              - !GetAtt 'HFNPublic.SecondaryPrivateIpAddresses'
            - '"'
            - ', "SbcPersonalityType"   : "'
            - !Ref 'SBCPersonality'
            - '"'
            - ', "SbcMgmtMode"          : "centralized"'
            - ', "TemplateName"         : "AWS_HA_template.json"'
            - ', "TemplateVersion"      : "V07.00.00A011"'
            - ', "CEName"               : "'
            - !Ref 'StandbyInstanceName'
            - '"'
            - ', "PeerCEName"           : "'
            - !Ref 'ActiveInstanceName'
            - '"'
            - ', "PeerCEHa0IPv4Address" : "'
            - !GetAtt 'SBCActiveHAIface.PrimaryPrivateIpAddress'
            - '"'
            - ', "SystemName"           : "'
            - !Ref 'SystemName'
            - '"'
            - ', "ActiveRoleMgtId"      : "'
            - !Ref 'SBCActiveMgtIface'
            - '"'
            - ', "NodeName"             : "'
            - !Ref 'AWS::StackName'
            - '" }'
    Metadata:
      AWS::CloudFormation::Designer:
        id: f70e440b-58bc-4b5e-973b-be57ea5e6f0a
  Ec2InstancePktARTAPkt0:
    Type: AWS::EC2::Instance
    Condition: NameValidationPassed
    Properties:
      ImageId: !Ref 'PKTARTAMIID'
      BlockDeviceMappings:
        - DeviceName: /dev/xvda
          Ebs:
            VolumeType: gp2
            VolumeSize: '50'
            DeleteOnTermination: 'true'
      InstanceType: !Ref 'PKTARTInstanceType'
      Tenancy: !Ref 'Tenancy'
      PlacementGroupName: !Ref 'PlacementId'
      EbsOptimized: 'True'
      KeyName: !Ref 'KeyName'
      NetworkInterfaces:
        - NetworkInterfaceId: !Ref 'PKTARTMgtA'
          DeviceIndex: '0'
        - NetworkInterfaceId: !Ref 'PKTARTPkt0'
          DeviceIndex: '1'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'AWS::StackName'
              - PKTARTA_Pkt0
    Metadata:
      AWS::CloudFormation::Designer:
        id: fef551d2-da30-43d4-a7ad-fbb8aab018f7
  Ec2InstancePktARTBPkt1:
    Type: AWS::EC2::Instance
    Condition: NameValidationPassed
    Properties:
      ImageId: !Ref 'PKTARTAMIID'
      BlockDeviceMappings:
        - DeviceName: /dev/xvda
          Ebs:
            VolumeType: gp2
            VolumeSize: '50'
            DeleteOnTermination: 'true'
      InstanceType: !Ref 'PKTARTInstanceType'
      Tenancy: !Ref 'Tenancy'
      PlacementGroupName: !Ref 'PlacementId'
      EbsOptimized: 'True'
      KeyName: !Ref 'KeyName'
      NetworkInterfaces:
        - NetworkInterfaceId: !Ref 'PKTARTMgtB'
          DeviceIndex: '0'
        - NetworkInterfaceId: !Ref 'PKTARTPkt1'
          DeviceIndex: '1'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'AWS::StackName'
              - PKTARTB_Pkt1
    Metadata:
      AWS::CloudFormation::Designer:
        id: 1939267c-cfa2-494f-af40-75f9b7fc226a
  HFEPublicSubnet:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref 'vpc'
      CidrBlock: !Ref 'HFNPublicPktSubnetCIDR'
      AvailabilityZone: !Ref 'availabilityZoneForSBC'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - hfnpublic_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: f06b1bad-206e-4dd9-9e53-cc535d3028b1
  HFEPrivateSubnet:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref 'vpc'
      CidrBlock: !Ref 'HFNTowardsSBCSubnetCIDR'
      AvailabilityZone: !Ref 'availabilityZoneForSBC'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - hfnprivate_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: '05ac7f13-5f07-47a7-a640-9401a865caae'
  HFEMgt:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'SBCManagementSubnet'
      Description: !Join
        - '-'
        - - !Ref 'SystemName'
          - HFEMgt
      GroupSet:
        - !Ref 'securityGrpMgtHFN'
      SourceDestCheck: 'true'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - HFEMgt
    Metadata:
      AWS::CloudFormation::Designer:
        id: 14eaaa3c-0e32-4db8-804e-e663fabe4f10
  HFNPublic:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'HFEPublicSubnet'
      Description: !Join
        - '-'
        - - !Ref 'SystemName'
          - HFN_Public
      GroupSet:
        - !Ref 'securityGrpPktUntrusted'
      SecondaryPrivateIpAddressCount: '1'
      SourceDestCheck: 'true'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - HFN_Public
    Metadata:
      AWS::CloudFormation::Designer:
        id: a0acde6f-56fb-45ed-9c4c-3a03a8b2d2c8
  hfnPublicEIP01:
    Type: AWS::EC2::EIP
    Properties:
      Domain: vpc
  hfnPublicEIPAssociation01:
    Type: AWS::EC2::EIPAssociation
    Properties:
      AllocationId: !GetAtt 'hfnPublicEIP01.AllocationId'
      NetworkInterfaceId: !Ref 'HFNPublic'
      PrivateIpAddress: !Select
        - '0'
        - !GetAtt 'HFNPublic.SecondaryPrivateIpAddresses'
  HFNPrivate:
    Type: AWS::EC2::NetworkInterface
    Condition: NameValidationPassed
    Properties:
      SubnetId: !Ref 'HFEPrivateSubnet'
      Description: !Join
        - '-'
        - - !Ref 'SystemName'
          - HFN_towards_SBC
      GroupSet:
        - !Ref 'securityGrpPktTrusted'
      SourceDestCheck: 'false'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - HFN_towards_SBC
    Metadata:
      AWS::CloudFormation::Designer:
        id: b255c65c-db21-40a1-8d81-4718b2fc68ba
  HFEMgtEIP:
    Type: AWS::EC2::EIP
    Condition: EipForHFEMgt
    Properties:
      Domain: vpc
    Metadata:
      AWS::CloudFormation::Designer:
        id: 4ce391cc-e5c8-4384-8bf7-333d0ee3e637
  HFNPktEIP:
    Type: AWS::EC2::EIP
    Condition: NameValidationPassed
    Properties:
      Domain: vpc
    Metadata:
      AWS::CloudFormation::Designer:
        id: 20c19626-8684-4fab-bcea-e0a6a1d5a95d
  HFNPktEIPAssociation:
    Type: AWS::EC2::EIPAssociation
    Condition: NameValidationPassed
    Properties:
      AllocationId: !GetAtt 'HFNPktEIP.AllocationId'
      NetworkInterfaceId: !Ref 'HFNPublic'
    Metadata:
      AWS::CloudFormation::Designer:
        id: 833d7e86-818b-4307-88c7-9fa053b2e126
  Ec2InstanceHFN:
    Type: AWS::EC2::Instance
    Condition: NameValidationPassed
    Properties:
      ImageId: !Ref 'HFNAMIID'
      BlockDeviceMappings:
        - DeviceName: /dev/xvda
          Ebs:
            VolumeType: gp2
            VolumeSize: '20'
            DeleteOnTermination: 'false'
      IamInstanceProfile: !Ref 'sweHFNIAMProfileName'
      InstanceType: !Ref 'InstanceType'
      Tenancy: !Ref 'Tenancy'
      PlacementGroupName: !Ref 'PlacementId'
      EbsOptimized: 'True'
      KeyName: !Ref 'KeyName'
      NetworkInterfaces:
        - NetworkInterfaceId: !Ref 'HFNPublic'
          DeviceIndex: '0'
        - NetworkInterfaceId: !Ref 'HFEMgt'
          DeviceIndex: '1'
        - NetworkInterfaceId: !Ref 'HFNPrivate'
          DeviceIndex: '2'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'AWS::StackName'
              - HFN
      UserData: !Base64
        Fn::Join:
          - ''
          - - 'Content-Type: multipart/mixed; boundary="//"'
            - "\nMIME-Version: 1.0"
            - "\n--//"
            - "\nContent-Type: text/cloud-config; charset=\"us-ascii\""
            - "\nMIME-Version: 1.0"
            - "\nContent-Transfer-Encoding: 7bit"
            - "\nContent-Disposition: attachment; filename=\"cloud-config.txt\""
            - "\n#cloud-config"
            - "\ncloud_final_modules:"
            - "\n- [scripts-user, always]"
            - "\n--//"
            - "\nContent-Type: text/x-shellscript; charset=\"us-ascii\""
            - "\nMIME-Version: 1.0"
            - "\nContent-Transfer-Encoding: 7bit"
            - "\nContent-Disposition: attachment; filename=\"userdata.txt\""
            - "\n#!/bin/bash"
            - "\nHFN_DIR=\"/home/ec2-user/HFN/\""
            - "\nHFN_FILE=\"$HFN_DIR/HFN.sh\""
            - "\nLOG_FILE=\"$HFN_DIR/cloud-init-nat.log\""
            - "\nNAT_VAR=\"$HFN_DIR/natVars.input\""
            - "\ntimestamp()"
            - "\n{"
            - "\ndate +\"%Y-%m-%d %T\""
            - "\n}"
            - "\nif [ ! -d $HFN_DIR ]; then"
            - "\nmkdir -p $HFN_DIR/;"
            - "\nfi;"
            - "\n/bin/echo $(timestamp) \" =========================    cloud-init\
              \ configuration for HFN    ==========================================\"\
              \ >> $LOG_FILE"
            - "\naws s3 cp "
            - !Ref 'HFNScriptS3Location'
            - ' $HFN_FILE'
            - "\nif [ $? -ne 0 ]; then"
            - "\n/bin/echo $(timestamp) \"Error:Could not copy HFN script from S3\
              \ bucket.\" >> $LOG_FILE"
            - "\nelse"
            - "\n/bin/echo $(timestamp) \"Copied HFN script from S3 bucket.\" >> $LOG_FILE"
            - "\nfi;"
            - "\n/bin/echo >  $NAT_VAR"
            - "\n/bin/echo \"SBC_SECONDARY_IP=\\\""
            - !Select
              - '0'
              - !GetAtt 'SBCActiveIVface.SecondaryPrivateIpAddresses'
            - \"" >> $NAT_VAR
            - "\n/bin/echo \"REMOTE_SSH_MACHINE_IP=\\\""
            - !If
              - EipForHFEMgt
              - !Ref 'remoteSSHMachinePublicIP'
              - ''
            - \"">> $NAT_VAR
            - "\n/bin/echo $(timestamp) \"Copied natVars.input\" >> $LOG_FILE"
            - "\nsudo chmod 744 $HFN_FILE"
            - "\nsudo /bin/bash $HFN_FILE setup"
            - "\n/bin/echo \"Configured using HFN script - $HFN_FILE\" >> $LOG_FILE"
            - "\n/bin/echo $(timestamp) \" =========================   Done    ==========================================\"\
              \ >> $LOG_FILE"
            - "\n--//"
    Metadata:
      AWS::CloudFormation::Designer:
        id: 61634ee6-9748-401e-ba4b-244e5605bd31
  mgtPKTARTBEIPAssociation:
    Type: AWS::EC2::EIPAssociation
    Condition: NameValidationPassed
    Properties:
      AllocationId: !GetAtt 'mgtPKTARTB.AllocationId'
      NetworkInterfaceId: !Ref 'PKTARTMgtB'
    Metadata:
      AWS::CloudFormation::Designer:
        id: e9bfea58-fd79-4ac2-916e-d8b6742b817f
  securityGrpHa:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Security group for Ha
      VpcId: !Ref 'vpc'
      SecurityGroupIngress:
        - IpProtocol: '-1'
          FromPort: '-1'
          ToPort: '-1'
          CidrIp: '0.0.0.0/0'
        - IpProtocol: '-1'
          FromPort: '-1'
          ToPort: '-1'
          CidrIp: !Ref 'sshAccessCIDR'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - SecurityGroup2_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: d8d608b3-82b1-4705-ae70-87dfcf0deeaf
  securityGrpPktTrusted:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Security group for SBC Pkt Trusted
      VpcId: !Ref 'vpc'
      SecurityGroupIngress:
        - IpProtocol: '-1'
          FromPort: '-1'
          ToPort: '-1'
          CidrIp: '0.0.0.0/0'
        - IpProtocol: '-1'
          FromPort: '-1'
          ToPort: '-1'
          CidrIp: !Ref 'sshAccessCIDR'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - SecurityGroup3_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: f30d88be-4005-419c-8475-a803ec2e1cca
  securityGrpMgtHFN:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Security group for HFN mgt
      VpcId: !Ref 'vpc'
      SecurityGroupIngress:
        - IpProtocol: '-1'
          FromPort: '-1'
          ToPort: '-1'
          CidrIp: '0.0.0.0/0'
        - IpProtocol: '-1'
          FromPort: '-1'
          ToPort: '-1'
          CidrIp: !Ref 'sshAccessCIDR'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - SecurityGroup4_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: 3a621b0c-8d54-4369-bf51-ad2a3cd75059
  securityGrpPktUntrusted:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Security group for SBC Pkt Untrusted
      VpcId: !Ref 'vpc'
      SecurityGroupIngress:
        - IpProtocol: '-1'
          FromPort: '-1'
          ToPort: '-1'
          CidrIp: '0.0.0.0/0'
        - IpProtocol: '-1'
          FromPort: '-1'
          ToPort: '-1'
          CidrIp: !Ref 'sshAccessCIDR'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - SecurityGroup5_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: f269b323-c76e-42e4-aa7b-9d7966433226
  securityGrpMgtPktart:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Security group for mgt PKTART
      VpcId: !Ref 'vpc'
      SecurityGroupIngress:
        - IpProtocol: '-1'
          FromPort: '-1'
          ToPort: '-1'
          CidrIp: '0.0.0.0/0'
        - IpProtocol: '-1'
          FromPort: '-1'
          ToPort: '-1'
          CidrIp: !Ref 'sshAccessCIDR'
      Tags:
        - Key: Name
          Value: !Join
            - '-'
            - - !Ref 'SystemName'
              - SecurityGroup6_Ribbon
    Metadata:
      AWS::CloudFormation::Designer:
        id: 5442027c-c91c-4bd8-8f04-cc2ba8f7c159
Outputs:
  InstanceIdActive:
    Condition: NameValidationPassed
    Value: !Ref 'SBCActiveInstance'
  DefaultCliAdminPassword:
    Description: 'It is eth0 interface-id of instance which has assigned active role
      in the template. This is used as default CLI admin password '
    Value: !Ref 'SBCActiveMgtIface'
  Mgt0InterfaceIDActive:
    Condition: NameValidationPassed
    Value: !Ref 'SBCActiveMgtIface'
  HA0InterfaceIDActive:
    Condition: NameValidationPassed
    Value: !Ref 'SBCActiveHAIface'
  Pkt0InterfaceIDActive:
    Condition: NameValidationPassed
    Value: !Ref 'SBCActiveIVface'
  Pkt1InterfaceIDActive:
    Condition: NameValidationPassed
    Value: !Ref 'SBCActiveEVface'
  InstanceIdStandby:
    Condition: NameValidationPassed
    Value: !Ref 'SBCPassiveInstance'
  Mgt0InterfaceIDStandby:
    Condition: NameValidationPassed
    Value: !Ref 'SBCPassiveMgtIface'
  HA0InterfaceIDStandby:
    Condition: NameValidationPassed
    Value: !Ref 'SBCPassiveHAIface'
  Pkt0InterfaceIDStandby:
    Condition: NameValidationPassed
    Value: !Ref 'SBCPassiveIVIface'
  Pkt1InterfaceIDStandby:
    Condition: NameValidationPassed
    Value: !Ref 'SBCPassiveEVIface'
  NameValidationError:
    Condition: NameMismatchError
    Value: Name Validation Failed
  ceNamesMatching:
    Condition: MatchingCeNames
    Value: CE Names of Active and Standby are same. ERROR. Not creating any resources.
  ActiveCeAndSystemNameMatching:
    Condition: MatchingActiveCeAndSystemName
    Value: CE Name of Active and System Name are same. ERROR. Not creating any resources.
  StandbyCeAndSystemNameMatching:
    Condition: MatchingStandbyCeAndSystemName
    Value: CE Name of Standby and System Name are same. ERROR. Not creating any resources.
Metadata:
  AWS::CloudFormation::Interface:
    ParameterGroups:
      - Label:
          default: Common and PKTART data
        Parameters:
          - KeyName
          - PKTARTInstanceType
      - Label:
          default: SBC Configuration
        Parameters:
          - InstanceType
          - AMIID
      - Label:
          default: Network Configuration
        Parameters:
          - vpcCIDR
          - SBCManagementSubnetCIDR
          - SBCHASubnetCIDR
          - SBCExVoipSubnetCIDR
          - availabilityZoneForSBC
      - Label:
          default: 'Optional: SBC configuration. For default configuration no need
            to change these values.'
        Parameters:
          - SBCPersonality
          - ActiveInstanceName
          - StandbyInstanceName
          - SystemName
          - Tenancy
          - PlacementId
          - VolumeType
          - IOPS
          - VolumeSize
  AWS::CloudFormation::Designer:
    7017e578-ebf0-497d-998e-e46e5515d284:
      size:
        width: 60
        height: 60
      position:
        x: 450
        y: 90
      z: 1
      embeds: []
    '072d5305-c1c0-4a9c-afda-2433e6e46df7':
      size:
        width: 60
        height: 60
      position:
        x: 570
        y: 210
      z: 1
      embeds: []
    513f2db5-2c59-4102-99aa-5ffd5bfe2508:
      size:
        width: 60
        height: 60
      position:
        x: 450
        y: 330
      z: 1
      embeds: []
    f679c8dc-690f-4034-8bfb-2eee03d54a82:
      size:
        width: 60
        height: 60
      position:
        x: 360
        y: 450
      z: 1
      embeds: []
      isassociatedwith:
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
        - f30d88be-4005-419c-8475-a803ec2e1cca
      iscontainedinside:
        - d835a872-3e6c-457a-b919-8bd3050a07ee
    f7fb0f52-ff36-4b59-bc5b-217c387fbc47:
      size:
        width: 60
        height: 60
      position:
        x: 360
        y: 570
      z: 1
      embeds: []
      isassociatedwith:
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
        - f30d88be-4005-419c-8475-a803ec2e1cca
      iscontainedinside:
        - 3c787d6b-e31a-4b68-b536-dc1a053e5fce
        - '05ac7f13-5f07-47a7-a640-9401a865caae'
    b937381e-0b5e-4899-8f9f-fe3a66be91c4:
      source:
        id: d0e9f652-4f8a-44f9-bfe5-2a978a9df748
      target:
        id: 6b3d4631-2742-42aa-8ccb-91ff44b4c6e3
      z: 3
    7cf86ffa-02d6-4532-a19d-e74d02805435:
      size:
        width: 60
        height: 60
      position:
        x: 480
        y: 570
      z: 1
      embeds: []
      isassociatedwith:
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
        - f30d88be-4005-419c-8475-a803ec2e1cca
      iscontainedinside:
        - d835a872-3e6c-457a-b919-8bd3050a07ee
    69dd4dbe-e79a-4dd6-a2c7-a8057eac1a37:
      size:
        width: 60
        height: 60
      position:
        x: 90
        y: 150
      z: 1
      embeds: []
      isassociatedwith:
        - 6e59ae5f-bbe3-449b-b133-fea19279bfdd
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
        - f30d88be-4005-419c-8475-a803ec2e1cca
      iscontainedinside:
        - 898c2c01-4023-4f19-b920-e0a27ae76685
        - 3c787d6b-e31a-4b68-b536-dc1a053e5fce
        - '05ac7f13-5f07-47a7-a640-9401a865caae'
    36268cbd-38bd-48ec-a98a-d2b8d92cab21:
      size:
        width: 60
        height: 60
      position:
        x: 600
        y: 450
      z: 1
      embeds: []
      isassociatedwith:
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
        - d8d608b3-82b1-4705-ae70-87dfcf0deeaf
      iscontainedinside:
        - f92c50bc-9290-4c7d-8e37-6b0bab95b230
    '00b911a7-2e7d-4201-9de0-db41c4ccbc0f':
      size:
        width: 60
        height: 60
      position:
        x: 600
        y: 570
      z: 1
      embeds: []
      isassociatedwith:
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
      iscontainedinside:
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
    4e8273a2-eda6-4000-bce9-66101cd18776:
      source:
        id: '072d5305-c1c0-4a9c-afda-2433e6e46df7'
      target:
        id: '00b911a7-2e7d-4201-9de0-db41c4ccbc0f'
      z: 1
    30b47652-4e3b-4e80-9241-e372d45af309:
      size:
        width: 60
        height: 60
      position:
        x: 690
        y: 90
      z: 1
      embeds: []
      isassociatedwith:
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
        - f30d88be-4005-419c-8475-a803ec2e1cca
      iscontainedinside:
        - d835a872-3e6c-457a-b919-8bd3050a07ee
    83463436-053b-441a-b7a3-203b0b4d6555:
      size:
        width: 60
        height: 60
      position:
        x: 210
        y: 150
      z: 1
      embeds: []
      isassociatedwith:
        - 6e59ae5f-bbe3-449b-b133-fea19279bfdd
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
        - f30d88be-4005-419c-8475-a803ec2e1cca
      iscontainedinside:
        - 898c2c01-4023-4f19-b920-e0a27ae76685
        - 3c787d6b-e31a-4b68-b536-dc1a053e5fce
        - '05ac7f13-5f07-47a7-a640-9401a865caae'
    51a951cd-ae03-4bff-a603-14f732be91d1:
      size:
        width: 60
        height: 60
      position:
        x: 690
        y: 330
      z: 1
      embeds: []
      isassociatedwith:
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
        - d8d608b3-82b1-4705-ae70-87dfcf0deeaf
      iscontainedinside:
        - f92c50bc-9290-4c7d-8e37-6b0bab95b230
    707aa6db-298f-4ad3-9852-dff6a57b6117:
      size:
        width: 60
        height: 60
      position:
        x: 720
        y: 450
      z: 1
      embeds: []
      isassociatedwith:
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
      iscontainedinside:
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
    f70e440b-58bc-4b5e-973b-be57ea5e6f0a:
      size:
        width: 60
        height: 60
      position:
        x: 720
        y: 570
      z: 1
      embeds: []
      isassociatedwith:
        - '00b911a7-2e7d-4201-9de0-db41c4ccbc0f'
        - 36268cbd-38bd-48ec-a98a-d2b8d92cab21
        - 69dd4dbe-e79a-4dd6-a2c7-a8057eac1a37
        - 7cf86ffa-02d6-4532-a19d-e74d02805435
    ccbc183f-09eb-4dc7-a4d9-0cc3a2ede5e8:
      size:
        width: 60
        height: 60
      position:
        x: 60
        y: 650
      z: 1
      embeds: []
      isassociatedwith:
        - 707aa6db-298f-4ad3-9852-dff6a57b6117
        - 51a951cd-ae03-4bff-a603-14f732be91d1
        - 83463436-053b-441a-b7a3-203b0b4d6555
        - 30b47652-4e3b-4e80-9241-e372d45af309
    8fdffd5a-b411-458e-9f0c-4504c85d2dcd:
      source:
        id: 7017e578-ebf0-497d-998e-e46e5515d284
      target:
        id: 707aa6db-298f-4ad3-9852-dff6a57b6117
      z: 1
    c2eac22a-dac3-43e8-a269-655a747809a3:
      source:
        id: 513f2db5-2c59-4102-99aa-5ffd5bfe2508
      target:
        id: 707aa6db-298f-4ad3-9852-dff6a57b6117
      z: 1
    '088537d6-da3e-4165-9cf2-356b0fe045b1':
      size:
        width: 60
        height: 60
      position:
        x: 1270
        y: -30
      z: 1
      embeds: []
    d0e9f652-4f8a-44f9-bfe5-2a978a9df748:
      size:
        width: 60
        height: 60
      position:
        x: 540
        y: 90
      z: 1
      embeds: []
    6ab84ccd-ec23-4e5b-b55a-a321f4275cfb:
      size:
        width: 60
        height: 60
      position:
        x: 1550
        y: 110
      z: 1
      embeds: []
      iscontainedinside:
        - 7b71f416-4973-476d-bedb-b332394c7da9
    7b71f416-4973-476d-bedb-b332394c7da9:
      size:
        width: 2130
        height: 1080
      position:
        x: 760
        y: 480
      z: 1
      embeds:
        - f92c50bc-9290-4c7d-8e37-6b0bab95b230
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
    d835a872-3e6c-457a-b919-8bd3050a07ee:
      size:
        width: 150
        height: 150
      position:
        x: 1200
        y: 120
      z: 1
      embeds: []
      iscontainedinside:
        - 7b71f416-4973-476d-bedb-b332394c7da9
    f92c50bc-9290-4c7d-8e37-6b0bab95b230:
      size:
        width: 150
        height: 150
      position:
        x: 940
        y: 870
      z: 2
      parent: 7b71f416-4973-476d-bedb-b332394c7da9
      embeds: []
      iscontainedinside:
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
    '00805611-6a39-4c0c-940d-dd2322aaec8b':
      size:
        width: 1170
        height: 360
      position:
        x: 1000
        y: 570
      z: 2
      parent: 7b71f416-4973-476d-bedb-b332394c7da9
      embeds:
        - '05ac7f13-5f07-47a7-a640-9401a865caae'
        - f06b1bad-206e-4dd9-9e53-cc535d3028b1
        - b68a0266-c1cc-4194-81c1-44d68061a4b2
        - 6b3d4631-2742-42aa-8ccb-91ff44b4c6e3
      iscontainedinside:
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
    b68a0266-c1cc-4194-81c1-44d68061a4b2:
      size:
        width: 60
        height: 60
      position:
        x: 1750
        y: 600
      z: 3
      parent: '00805611-6a39-4c0c-940d-dd2322aaec8b'
      embeds: []
      isassociatedwith:
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
      iscontainedinside:
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
    6b3d4631-2742-42aa-8ccb-91ff44b4c6e3:
      size:
        width: 60
        height: 60
      position:
        x: 1630
        y: 600
      z: 3
      parent: '00805611-6a39-4c0c-940d-dd2322aaec8b'
      embeds: []
      isassociatedwith:
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
      iscontainedinside:
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
    1939267c-cfa2-494f-af40-75f9b7fc226a:
      size:
        width: 60
        height: 60
      position:
        x: 420
        y: 180
      z: 1
      embeds: []
      isassociatedwith:
        - 6b3d4631-2742-42aa-8ccb-91ff44b4c6e3
        - f7fb0f52-ff36-4b59-bc5b-217c387fbc47
        - b68a0266-c1cc-4194-81c1-44d68061a4b2
        - f679c8dc-690f-4034-8bfb-2eee03d54a82
    fef551d2-da30-43d4-a7ad-fbb8aab018f7:
      size:
        width: 60
        height: 60
      position:
        x: 660
        y: 180
      z: 1
      embeds: []
      isassociatedwith:
        - 6b3d4631-2742-42aa-8ccb-91ff44b4c6e3
        - f7fb0f52-ff36-4b59-bc5b-217c387fbc47
    229e8cd7-1798-42ce-8ce6-b0a0a450eea3:
      size:
        width: 60
        height: 60
      position:
        x: 180
        y: 240
      z: 1
      embeds: []
    4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec:
      size:
        width: 240
        height: 240
      position:
        x: 2200
        y: 540
      z: 2
      parent: 7b71f416-4973-476d-bedb-b332394c7da9
      embeds:
        - 90ec2540-d898-4e67-a372-91ff0651b6f5
      iscontainedinside:
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
        - 7b71f416-4973-476d-bedb-b332394c7da9
    6d21e83b-ffe7-4d07-a8d1-7e64a97cdeb4:
      source:
        id: 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
      target:
        id: f06b1bad-206e-4dd9-9e53-cc535d3028b1
      z: 3
    cc96f861-6568-4d28-a28f-dc992218f776:
      source:
        id: 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
      target:
        id: '00805611-6a39-4c0c-940d-dd2322aaec8b'
      z: 2
    90ec2540-d898-4e67-a372-91ff0651b6f5:
      size:
        width: 60
        height: 60
      position:
        x: 2230
        y: 600
      z: 3
      parent: 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
      embeds: []
      isassociatedwith:
        - 229e8cd7-1798-42ce-8ce6-b0a0a450eea3
      iscontainedinside:
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
        - 4afd89d8-2cb1-47b0-be81-1ceccb0ab5ec
    bf4c840c-e410-459b-921c-0db5161ab36c:
      source:
        id: 7b71f416-4973-476d-bedb-b332394c7da9
      target:
        id: 229e8cd7-1798-42ce-8ce6-b0a0a450eea3
      z: 1
    fc6b28b4-fb76-4ba8-b58a-d0e9f2e208ee:
      size:
        width: 60
        height: 60
      position:
        x: 300
        y: 300
      z: 1
      embeds: []
    34ea8f05-a010-4451-bba1-0a76dc41df9e:
      size:
        width: 60
        height: 60
      position:
        x: 540
        y: 300
      z: 1
      embeds: []
      isassociatedwith:
        - fc6b28b4-fb76-4ba8-b58a-d0e9f2e208ee
    9e06684e-8dc2-4a28-abce-032d28c96f15:
      size:
        width: 60
        height: 60
      position:
        x: 60
        y: 360
      z: 1
      embeds: []
    513abf27-ab1b-4f87-85ed-dfdc313a4ef7:
      size:
        width: 60
        height: 60
      position:
        x: 180
        y: 360
      z: 1
      embeds: []
      isassociatedwith:
        - 9e06684e-8dc2-4a28-abce-032d28c96f15
    f06b1bad-206e-4dd9-9e53-cc535d3028b1:
      size:
        width: 140
        height: 140
      position:
        x: 1370
        y: 740
      z: 3
      parent: '00805611-6a39-4c0c-940d-dd2322aaec8b'
      embeds: []
      iscontainedinside:
        - 7b71f416-4973-476d-bedb-b332394c7da9
    '05ac7f13-5f07-47a7-a640-9401a865caae':
      size:
        width: 140
        height: 140
      position:
        x: 1040
        y: 670
      z: 3
      parent: '00805611-6a39-4c0c-940d-dd2322aaec8b'
      embeds: []
      iscontainedinside:
        - 7b71f416-4973-476d-bedb-b332394c7da9
    14eaaa3c-0e32-4db8-804e-e663fabe4f10:
      size:
        width: 60
        height: 60
      position:
        x: 290
        y: 690
      z: 0
      embeds: []
      isassociatedwith:
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
      iscontainedinside:
        - '00805611-6a39-4c0c-940d-dd2322aaec8b'
    a0acde6f-56fb-45ed-9c4c-3a03a8b2d2c8:
      size:
        width: 60
        height: 60
      position:
        x: 419.14213367242775
        y: 660.7073897339251
      z: 0
      embeds: []
      isassociatedwith:
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
        - f30d88be-4005-419c-8475-a803ec2e1cca
      iscontainedinside:
        - f06b1bad-206e-4dd9-9e53-cc535d3028b1
    b255c65c-db21-40a1-8d81-4718b2fc68ba:
      size:
        width: 60
        height: 60
      position:
        x: 545.2984834340347
        y: 675.3039921856813
      z: 0
      embeds: []
      isassociatedwith:
        - 6ab84ccd-ec23-4e5b-b55a-a321f4275cfb
        - f30d88be-4005-419c-8475-a803ec2e1cca
      iscontainedinside:
        - '05ac7f13-5f07-47a7-a640-9401a865caae'
    4ce391cc-e5c8-4384-8bf7-333d0ee3e637:
      size:
        width: 60
        height: 60
      position:
        x: 210
        y: 710
      z: 0
      embeds: []
    20c19626-8684-4fab-bcea-e0a6a1d5a95d:
      size:
        width: 60
        height: 60
      position:
        x: 470
        y: 740
      z: 0
      embeds: []
    7fdb903d-a9c1-410b-b61b-f48b455b9b31:
      source:
        id: 4ce391cc-e5c8-4384-8bf7-333d0ee3e637
      target:
        id: 14eaaa3c-0e32-4db8-804e-e663fabe4f10
      z: 0
    833d7e86-818b-4307-88c7-9fa053b2e126:
      source:
        id: 20c19626-8684-4fab-bcea-e0a6a1d5a95d
      target:
        id: a0acde6f-56fb-45ed-9c4c-3a03a8b2d2c8
      z: 0
    61634ee6-9748-401e-ba4b-244e5605bd31:
      size:
        width: 60
        height: 60
      position:
        x: 629.459520009777
        y: 719.7591808145539
      z: 0
      embeds: []
      isassociatedwith:
        - a0acde6f-56fb-45ed-9c4c-3a03a8b2d2c8
        - 14eaaa3c-0e32-4db8-804e-e663fabe4f10
        - b255c65c-db21-40a1-8d81-4718b2fc68ba
    e9bfea58-fd79-4ac2-916e-d8b6742b817f:
      source:
        id: '088537d6-da3e-4165-9cf2-356b0fe045b1'
      target:
        id: b68a0266-c1cc-4194-81c1-44d68061a4b2
      z: 3
    d8d608b3-82b1-4705-ae70-87dfcf0deeaf:
      size:
        width: 60
        height: 60
      position:
        x: 1560
        y: -60
      z: 1
      embeds: []
      iscontainedinside:
        - 7b71f416-4973-476d-bedb-b332394c7da9
    f30d88be-4005-419c-8475-a803ec2e1cca:
      size:
        width: 60
        height: 60
      position:
        x: 1560
        y: 10
      z: 1
      embeds: []
      iscontainedinside:
        - 7b71f416-4973-476d-bedb-b332394c7da9
    3a621b0c-8d54-4369-bf51-ad2a3cd75059:
      size:
        width: 60
        height: 60
      position:
        x: 1640
        y: 110
      z: 1
      embeds: []
      iscontainedinside:
        - 7b71f416-4973-476d-bedb-b332394c7da9
    f269b323-c76e-42e4-aa7b-9d7966433226:
      size:
        width: 60
        height: 60
      position:
        x: 1680
        y: 10
      z: 1
      embeds: []
      iscontainedinside:
        - 7b71f416-4973-476d-bedb-b332394c7da9
    5442027c-c91c-4bd8-8f04-cc2ba8f7c159:
      size:
        width: 60
        height: 60
      position:
        x: 1740
        y: 120
      z: 1
      embeds: []
      iscontainedinside:
        - 7b71f416-4973-476d-bedb-b332394c7da9
